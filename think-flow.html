<!DOCTYPE html>
<html lang="zh-cmn-hans">
<head>
	<meta charset="utf-8">
	<title>[Encrypted] Think flow — Shangfute's Blog</title>
	<meta name="description" content="Title: [Encrypted] Think flow; Date: 2016-04-06; Author: 尚福特">
	<meta name="author" content="尚福特">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://shangfute.github.com/theme/html5.js"></script>
		<![endif]-->
	<link href="http://shangfute.github.com/theme/css/ipython.css" rel="stylesheet">
	<link href="http://shangfute.github.com/theme/css/bootstrap.min.css" rel="stylesheet">
	<link href="http://shangfute.github.com/theme/css/font-awesome.min.css" rel="stylesheet">
	<link href="http://shangfute.github.com/theme/css/local.css" rel="stylesheet">
	<link href="http://shangfute.github.com/theme/css/pygments.css" rel="stylesheet">
</head>
<body>
<div class="container">
	<div class="page-header">
		<h1><a href="http://shangfute.github.com/">Shangfute's Blog</a>
			<br><small>Cryptography & Program Anaylsis</small></h1>	</div>
	<div class="row">
		<div class="col-md-8 col-md-offset-2">
<div class="article" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="text-center article-header">
		<h1 itemprop="name headline" class="article-title">[Encrypted] Think flow</h1>
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<h4 itemprop="name">尚福特</h4>
		</span>
		<time datetime="2016-04-06T09:37:44+08:00" itemprop="datePublished">周三 06 四月 2016</time>
	</div>
	<div>
		Category:
		<span itemprop="articleSection">
			<a href="http://shangfute.github.com/category/life.html" rel="category">life</a>
		</span>
	</div>
 
	<div>
		Tags:
		<span itemprop="keywords">
			<a href="http://shangfute.github.com/tag/thought.html" rel="tag">thought</a>
		</span>
		<span itemprop="keywords">
			<a href="http://shangfute.github.com/tag/daily.html" rel="tag">daily</a>
		</span>
	</div>
	<div itemprop="articleBody" class="article-body"><div id="pec-encrypted-content" style="display:none">ryjHnUFsih+CF73y14HJRA==;nuoBCntzBrIP/Vu6oS7WEDCFTiySulZ3BmXg4MZW4tqW1IaQcQkOWB5al6hNrau7CaBy44PyR7Wp4UP3uasvA6wj1yOLbE+Zrx38ngPIW75DsfkxBw6qjHWb4CfpSopF/tOTm8uWPq/Wf6EozkeggKfESimuY5EKwU03KWX0Wlw6tmdQxD9rJB8e3ySNm9rWRZjX2iW+cfMHxFrgZJO3ezfZtc0vintUW2ErBDa8EoTRV7fcjij0v2CD4n6i4+Mlsu3RVhyosuEuBgjtJFrOMvXnxDv/wktivzrA199i78VriyIMkHXbNxSJ6ZR2yEc3t+ESZYAEPSTql4Ui3h2xTAiqsseoRzv9lKl7J3YEAY4fYqNEPoDz8ncE9nkWrOI8MgnPmQBZZ1AzUCifef0BOs8Y0bkuY10RDHKgFPbsGDt2APhyCybHYidSgHjw1alfj8eOE0ru/BWy4yjP9QU+7+mKHCl/JCg3HroazB4I1fisnCUoj4gKzHNG1ojEda9RvYa/Dn+UV3DA3asY5XBgfyxK6HvtfqqR9OIeUvwH5a9hOCQwmoEPlYkm4Ij4jt9fzjY7vPL/ec3cb+lRH5Jn+qOmuNDjLIlFudJw+MiXG8YPmlVNXW/d5o0coEiucK2T2NesVx4M+LrqSrJBFWZsHAphgGT7SaGJ7wSUt5+sqLZWWktdnlEnQh5NjaS+bjAP/1xagIIslrjg68+FLypGGAb3OngoDQdGIniRnNw0V/ifXYNELl5vMQQkwqQv1NZWzHOReD6coxzjonC8bjnSo1nk33TRKsVOXxLBdArCPn9Asl9KNYhQqRmCPONlTf45oOhMeZD58InKPiNBiePQaYnwVmohOmDabkY9zwUT4Z5lFZPThoThCbElvQVCTkfBz1mI3g7/a68fwXOgTzOJ4vZgEzhVG8Rf3AY4FyMqHXxoTOTNahlbaHPS5HGlre9xcg/7UIejsUFgmzTm8RcrAQ+c0EE+APdV2FmCnmy8o0b4ckvLG8PiOhtVt8c2RTVYbEbtb51Z9konJwu9LSKczbLOwH8RI3zZ6EMXpvNMxaptnekQN2w2gyDL9gXj/nfdTH5SbTfXPWKON7tDNbnWuV6bMbAYb3m0r81pkxC9AzFOfkbEk2LUt5QT/ASe9B1IIGbuLJtcGO4pRl71mIzTO91hN/FmdhOELrxIFzSQgqDzEQOQM26WVgNFxwMyUns/XOum0Lin68JG9ANfu5i6el5dj5NHL+1v0VoT+47TllJMTLXPbpfKvuBBEbKYAJSH5v5mojChk9LGkVUo4awgKIS2f2ar5RxNs0SuQgvGbkKJhsgMG4Cb/wsCbx3wZ+qRtYWjlsOJgsam1F+5yivYCBGLIiZW0D+mqxDPKj5wM8bzVjj7FE/XUTCCZj4SSsq1LbLbBpxtv3yURe6/BmNmqT9qU8SQPe6T8cO9Z+R4rGClnjofdGXPgSFlQheB5i7nLcJnRL8wulXJINFMQX9O+XpdyhM7+zdQU9wHLNS1LXR/ZO+WHqwODKLZj5+BnDAf1KLqG3oXR78AQCzQmaQc4X25+0NFc18wXUHzhx8LMYmM71ZNjv1KoZg+p8eIt813848GWTpKR3PjtjUhc6NhMOYyMqmH8Uzv1ZE7OZLFAHC53I+RP3+lBLABnJwXqEvX+9+PweRuy6qtGyr0LEXd8hhENgG8MuoPNb/E+NxC1S1TNaC8Dp6KdG6OiWPBSWNIIUwmsrBcCCFRW68+D5T69EaQ58XrZH+pmuFqMFhyL0nHgpDfKQyjCudpi6zCIQJ/Lb8+027gRX+XM91RgIV6/+8MExi7SEs2g+qoy8hnLklVIVFin69pTaWShyqIRYs4d1bCKM3vkmgK4CI6IB587OmJpXDJ5UNAaQ1/QQ9+OoPX+U7blBRv6lYZp1eVgstams2jHYLevbrdSf2UTONWNkS2qNmZ95+r22rTZN3O2NxHRgE80YAs5DtoFL1SPJqkayVekMnmEpoyZpyAy3LHOadIOAtumlgM7a/PsMUGKZExY/L+KhCGV+j8xz9ZgeenQleBPRWRzg98m0YDA97sQxlqwq3oa/7X8zeM5oGfpGDuMWDvpXPY6A6bBDbtkYu8gu+vrKI5QeGU+NmX3T+qFV5Qf8IsPxOvSN7d22Cu77G2ovHwzd/ZEb9A+42kJeRF/Vs/hyufBHxT/hGXYdUjvbNQce9IcbwpesCxXpMOdrv7iu74qPHl0Ota9tQD/oXd6oDf0qV+/wLWyhzRDNI+eqPhDZoEqYKR0ytG9FwRrJdoeFYJSXNyiCvFY6YDaGVyIns751iXqUQ2pteju06wtevmdzWTFYc+GHsITgjTnRRqntjJBO8Tf/qyDPCDqvdnseHEnHVPH71r3HRQpLJBJPQJ8KzA/wHpB0eEET7gUYiwVFZicHv1VOfQBy7FYs2J173BaXsqKKyxZ7Ux6CAzcRrPBTr4tKtDIHgvdSjnGvo0f0Y4XvNn1z7SEk3cLqhOB0b+2jVmYpeAhpQ/56THkt3EKmb2E+3LJ8sApRD0woqo6BL6RVDZEYDP0Fv0qRc6TKNBDghy76dG8xOFZSyfE3Ng+oL+uUjnnYi2XBefQraJB1VhIEiEMMc07nhvJkFeNGoefYvqkPgVHWtAP+g2jTd4JfKjjBtBl1RYwQCVrFZwRwfm/ybWUHLFi327TWkjMW33rvwg8bUkAYUt+47A8k8SWy40MbpYXE0VMPub6QgedXli4u+5PUM7DxkFciQc+z0rsNG4/1dMd6foB115LrGKztYbLYH9lgC7qjLuPVdTknhx7zCSJq0l5pn56iShqbHKSiHFP2h8tZHVwI/iw8alKH6ouVWx7FgeYwVaUDEp8wPN5TaqlvSjL1KAk6G/50VUZuixku2QDNj5RPngNwfMlm4Oyrk4Xtr+uq9BapUj7AoXtoS9c0TTXeFXH3+yyFWsuxpk+EgIF0qQw7EmWfu/wjPTiQOdK8M3tANfaPutXl844IkxMhV0wG83QZBI8guRrzWe01a0mikZmpWHqDnPa6OHRevWBB8MtEfu9fBLJ+ezn5uQhm6h3X2ndSZXsCJKyfpozzns7W1pAQh9o5hCyXw2Fqyl0/8WC9l1iIPHC/TpC6/d1QMQsMfWKUuMYixLVw8rAvKYlivva/hu07yfTz1mMU7tYTZo3koC7HTY4JMQcd7b4v8VXXR6R+swHzXAfCQCsai/+cucc9hvqOvuzRugAuWoRWY8yCSpXa9wV4hoxjYeUAm1aVYKngZPXwHh/vvlJD3Igq+ZJuUtig4BHPjnX6WNwscSlmP6HwaekeVhaAMR7JvXGftG7waXpwpKC+bG6Z9KFZtUG3nGP6ffDRfU5N5fPDt9KvbpbYivhIf+C84IipQoJT4c5ahQ3U3YDBxUvs+2gTv7Sij8/0tonibtgQ2hbsmNUFxS5vCpFPiicrENfQ6cBk+S2KhAnnkznk7fy+ZtaCc6EqNUIpQ13p/nNmERF0LmTmJXQUwHpRY+bEGdSCCRt2PkzFvamge1A2kBmRDH/yx+T9zPxiyiVrYzSB2gko8r7NROcBKiB95+K7nHOXeLKTyNjPIyl3viWZL6nbH6ZI6Mfrx7C904kXpqIoKzvHd7SwUOk1QUUDX+19zHC8PgNjcPPt5lWN6ulrRuGFa2l09UDxbpqhqWgKnjxwsrTFzjH0q4xVOnXzV372XsxUdjxEbVC4achAs6YMfgd+JuqhZBNFl2FBxhHLcpcSr7yy0tN/Gtc2zUht/sb2QTDGJDPU97FZiUzvCyrMeKDDRmoDMBI65zqXRBm1okj1nFj+aIu1xu2Wa7tT/brrebDLcGlxJJN9diUr+1EVw1JN2KwvenjtfjK70cTR3yuiGm6yoH5OraQRG/+wtFPCqPZqJxadsDk+Ay46mUyWJmeEtcT7CR3utILrXHeyQC1DtorApzpWIl4YvzZMkYBFuObqecAwbSKXqksB3IX4ZCetcGEUUnXp3OkDilnzud4F7dYePZ2lUJ6IsHqjqMPH9qJ53LI3TjdpRs357tq2+uuJOC0UxZcVfWU3svVTlhHTP0acAQg+lTKfrGXr0KIjsBWkMl0yOwvqmBlzVgUrsiObbMGWvt65PZt+a4WqTjj163twC0Q5lrPT9vCAddMSKowjkzEnU3WKMiJQw2HtjeEP83EDqYrmOc+dN367xWG4izPmgATU3EBhhXjY6JqjI4WdK2FCjyk96iWpmgRBpJbcB6AaFxxlxjlyCglSr4AXk4jieO688HLwoPPByrNgW3aWy8NVHNdvGm0sS6z9G7foj/ZRXU4ei7yw==;^</div>
<div id="pec-decrypted-content">
    <h4><i>This content is encrypted.</i></h4>
</div>

<form id="pec-decrypt-form">
    <label for="pec-content-password">Password</label>
    <input type="password" id="pec-content-password" placeholder="Password" />
    <button type="button" id="pec-decrypt-content">Decrypt</button>
</form>


    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/core.js"></script>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/enc-base64.js"></script>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/cipher-core.js"></script>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/pad-nopadding.js"></script>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/md5.js"></script>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/aes.js"></script>


<script type="text/javascript">
    (function () {
        var strip_padding = function (padded_content, padding_char) {
            /*
             * Strips the padding character from decrypted content.
             */
            for (var i = padded_content.length; i > 0; i--) {
                if (padded_content[i-1] !== padding_char) {
                    return padded_content.slice(0, i);
                }
            }
        };

        var decrypt_content = function (password, iv_b64, ciphertext_b64, padding_char) {
            /*
             * Decrypts the content from the ciphertext bundle.
             */
            var key = CryptoJS.MD5(password),
                iv = CryptoJS.enc.Base64.parse(iv_b64),
                ciphertext = CryptoJS.enc.Base64.parse(ciphertext_b64),
                bundle = {
                    key: key,
                    iv: iv,
                    ciphertext: ciphertext
                };

            var plaintext = CryptoJS.AES.decrypt(bundle, key, {iv: iv, padding: CryptoJS.pad.NoPadding});

            try {
                return strip_padding(plaintext.toString(CryptoJS.enc.Utf8), padding_char);
            }
            catch (err) {
                // encoding failed; wrong password
                return false;
            }
        };

        var init_decryptor = function() {
            var decrypt_btn = document.getElementById('pec-decrypt-content'),
                password_input = document.getElementById('pec-content-password'),
                encrypted_content = document.getElementById('pec-encrypted-content'),
                decrypted_content = document.getElementById('pec-decrypted-content'),
                decrypt_form = document.getElementById('pec-decrypt-form');

            decrypt_btn.addEventListener('click', function () {
                // grab the ciphertext bundle
                var parts = encrypted_content.innerHTML.split(';');

                // decrypt it
                var content = decrypt_content(
                    password_input.value,
                    parts[0],
                    parts[1],
                    parts[2]
                );

                if (content) {
                    // success; display the decrypted content
                    decrypted_content.innerHTML = content;
                    decrypt_form.parentNode.removeChild(decrypt_form);
                    encrypted_content.parentNode.removeChild(encrypted_content);

                    // any post processing on the decrypted content should be done here
                }
                else {
                    // ¯\_(ツ)_/¯
                    password_input.value = '';
                }
            });
        };

        document.addEventListener('DOMContentLoaded', init_decryptor);
    })();
</script></div>
	<hr>
	<h2>Comments</h2>
<!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="think-flow.html" data-title="[Encrypted] Think flow" data-url="http://shangfute.github.com/think-flow.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"shangfute"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>

<!-- 多说公共JS代码  --></div>
		</div>
	</div> 	<!-- <hr> -->
</div> <!-- /container -->
<footer class="aw-footer bg-success">
	<div class="container"> <!-- footer -->
		<div class="row">
			<div class="col-md-10 col-md-offset-1">
				<div class="row">
					<div class="col-md-3">
						<h4>Navigation</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="http://shangfute.github.com">Shangfute's Blog</a></li>
							<li><a href="http://shangfute.github.com/feeds/all.atom.xml" type="application/atom+xml"><i class="fa fa-rss "></i> atom</a></li>
							<li><a href="http://shangfute.github.com/feeds/all.rss.xml" type="application/rss+xml"><i class="fa fa-rss "></i> rss</a></li>
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Author</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="mailto://shangfute@163.com">shangfute</a></li>
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Categories</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="http://shangfute.github.com/category/life.html">life (1)</a></li>
							<li><a href="http://shangfute.github.com/category/web.html">web (2)</a></li>
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Links</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="http://freebuf.com/">Freebuf</a></li>
							<li><a href="http://litengyao.com">ltyleader</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</footer>
<div class="container">
	<div class="row">
		<div class="col-md-12 text-center center-block aw-bottom">
			<p>&copy; 尚福特 2016</p>
		</div>
	</div>
</div>
<!-- JavaScript -->
<script src="http://shangfute.github.com/theme/js/jquery-2.1.1.min.js"></script>
<script src="http://shangfute.github.com/theme/js/bootstrap.min.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
	$("div.collapseheader").click(function () {
		$header = $(this).children("span").first();
		$codearea = $(this).children(".input_area");
		$codearea.slideToggle(500, function () {
			$header.text(function () {
				return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
			});
		});
	});
});
</script>
</body>
</html>